단위 테스트(Unit test)란?
---

<br>

### 단위 테스트와 통합 테스트

- 단위테스트 : 하나의 모듈을 중심으로 독립적으로 진행되는 최소단위의 테스트
여기서 모듈이란 하나의 기능, 메소드를 뜻한다. 예를 들어 특정 메소드에 대한 독립적 테스트가 1개의 단위 메소드가 될 수 있다. 하나의 기능에 대한 테스트가 진행되는 것이므로 단순 표현한다면 어떤 기능을 실행하면 어떤 결과가 나온다 정도로 테스트한다고 볼 수 있다.

<br>

- 통합 테스트 : 모듈을 통합하는 과정에서 모듈 간의 통합성을 확인하기 위해 수행되는 테스트이다. 보편적인 애플리케이션은 여러개의 모듈로 구성되고 모듈끼리 상호작용하며 기능을 수행한다. 그렇기 때문에 모듈간의 연계, 동작에 대한 검증이 필요하다. 이것에 대한 테스트가 통합테스트이다. 따라서 통합테스트는 독립적 기능에 대한 테스트가 아니라 API를 호출하여 올바르게 동작하는 지 확인하는 테스트이다.

<br>

### 단위 테스트의 필요성

<br>

- 실무에서 이루어지는 대부분의 테스트는 단위테스트이다. 통합 테스트의 경우 실제 여러 컴포넌트간의 상호작용을 테스트하기 때문에 모든 컴포넌트들이 구동된 상태에서 테스트를 진행한다. 따라서 통합테스트 진행 시에는 캐시, 데이터베이스 등 다른 컴포넌트들과 실제 연결을 해야하고 이에 따른 가동되는 컴포넌트 수에 비례하여 비용이 증가한다. 반면에 단위 테스트는 **해당 부분만 독립적으로 테스트하기 때문에 어떤 코드를 리팩토링하여도 빠르게 문제 여부를 확인 가능하다.**

<br>

- 간단하게 정리하자면 단위 테스트의 장점은 다음과 같다.
    - 테스팅에 대한 시간과 비용을 절감 가능하다.
    - 새로운 기능 추가 시 빠른 테스트가 가능하다.
    - 리팩토링 시 안정성 확보가 가능하다.
    - 코드에 대한 문서가 될 수 있다.

<br>

- 따라서 실무에서는 단위 테스트를 선호하며, 요즘 많이 사용되는 TDD(Test-Driven Development)에서 이야기 하는 테스트도 단위테스트를 뜻한다. 개발자는 **테스트 코드를 빠르게 돌리면서 문제를 파악하는 것이** 단위테스트를 사용하면 가능하다.

<br>

### 단위 테스트의 문제점

<br>

- 단위 테스트는 해당 모듈에 대한 독립적인 테스트이기 때문에 다른 객체와 메시지를 주고 받는 경우 문제가 발생한다. 따라서 **다른 객체 대신에 가짜 객체(Mock Object)를 주입하여 특정 결과를 반환하라고 고정된 답변을 준비** 시켜야 한다. 이를 **stub**이라고 한다.

<br>

- 예를 들어 DB에 새로운 데이터를 추가하는 코드를 테스트하고자 할 때, 가짜 DB(Mock Database)를 주입하여 insert 처리 시에 반드시 1을 반환해주도록 하는 것이 stub이다.

<br>


### 좋은 단위 테스트의 특징

<br>

- 보편적으로 요구사항은 지속적으로 변화하고 코드 또한 이에 따라서 변경되는데 이러한 특성이 버그발생의 원인이 될 수 있다. 따라서 **좋은 테스트 코드는 변경된 코드를 검증하는 것이라고 볼 수 있다.* 또한 실제 코드가 변경되면 테스트 코드 또한 변경될 수 있는데 이러한 이유로 테스트 코드 또한 가독성있게 작성될 필요성이 있다.
<br><br>
따라서 테스트 작성시에는 다음을 준수하는 것이 좋다.
  1. 1개 테스트에 대해서 assert 최소화
  2. 1개의 테스트 함수는 1개의 개념만을 테스트
   
- 또한 좋고 깨끗한 코드는 FIRST라는 5가지 규칙을 따라야한다.
    1. Fast : 테스트는 빠르게 동작하여 자주 동작할 수 있어야 한다.
    2. Independent : 각각의 테스트는 독립적이며 서로 의존해서는 안된다.
    3. Repeatable : 어느 환경에서도 반복 가능해야 한다.
    4. Self-Validating : 테스트는 성공 또는 실패 boolean 값으로 결과를 내어 자체적으로 검증 가능해야 한다.
    5. Timely : 테스트는 적시에 즉, 테스트하려는 실제 코드를 구현하기 직전에 구현해야 한다.

<br>

## 출처

<br>

- 해당 작성글은 https://mangkyu.tistory.com/ 의 운영자 분이 CleanCode 책을 기반으로 작성하신 게시물을 참고하여 서술하였습니다.
